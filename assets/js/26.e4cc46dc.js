(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{473:function(t,s,e){"use strict";e.r(s);var a=e(8),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"cosmwasm-with-testnet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cosmwasm-with-testnet"}},[t._v("#")]),t._v(" CosmWasm with Testnet")]),t._v(" "),e("p",[t._v("The following is a quick guide that shows the basics of deploying a contract to a Osmosis Testnet ("),e("code",[t._v("osmo-test-4")]),t._v("). It covers:")]),t._v(" "),e("ul",[e("li",[t._v("Initial Setup\n"),e("ul",[e("li",[t._v("Setup Rust")]),t._v(" "),e("li",[t._v("Setup Osmosis Testnet via Osmosis Installer")]),t._v(" "),e("li",[t._v("Setup Client")])])]),t._v(" "),e("li",[t._v("Deploy a Smart Contract\n"),e("ul",[e("li",[t._v("Clone cw-template")]),t._v(" "),e("li",[t._v("Compile the wasm contract with stable toolchain")]),t._v(" "),e("li",[t._v("Optimized Compilation")]),t._v(" "),e("li",[t._v("Store to Osmosis Testnet chain")]),t._v(" "),e("li",[t._v("Instantiate the contract")])])]),t._v(" "),e("li",[t._v("Execute the Contract\n"),e("ul",[e("li",[t._v("Get contract’s count")]),t._v(" "),e("li",[t._v("Increment contract’s count")]),t._v(" "),e("li",[t._v("Reset contract’s count")])])]),t._v(" "),e("li",[t._v("Osmo Contract Explorer\n"),e("ul",[e("li",[t._v("Upload the code")]),t._v(" "),e("li",[t._v("Execute the contract")])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Please note this a detailed guide on how to deploy via "),e("code",[t._v("osmosisd")]),t._v(", it also covers additional tooling and useful tips.  You can also deploy to testnet with "),e("RouterLink",{attrs:{to:"/developing/dapps/get_started/cosmwasm-testnet-beaker.html"}},[t._v("Beaker")]),t._v(" with a couple of commands.")],1)]),t._v(" "),e("h2",{attrs:{id:"initial-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#initial-setup"}},[t._v("#")]),t._v(" Initial Setup")]),t._v(" "),e("p",[t._v("This tutorial uses a Osmosis specific development tools to deploy contracts to Osmosis Testnet("),e("code",[t._v("osmo-test-4")]),t._v(").")]),t._v(" "),e("h3",{attrs:{id:"setup-rust"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup-rust"}},[t._v("#")]),t._v(" Setup Rust")]),t._v(" "),e("p",[t._v("Rust is the main programming language used for CosmWasm smart contracts. While WASM smart contracts can theoretically be written in any programming language, CosmWasm libraries and tooling work best with Rust.")]),t._v(" "),e("p",[t._v("First, "),e("a",{attrs:{href:"https://rustup.rs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("install rustup"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Then run the following commands:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. Set 'stable' as the default release channel:")]),t._v("\nrustup default stable\ncargo version\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If this is lower than 1.50.0+, update")]),t._v("\nrustup update stable\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. Add WASM as the compilation target:")]),t._v("\nrustup target list --installed\nrustup target "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" wasm32-unknown-unknown\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. Install the following packages to generate the contract:")]),t._v("\ncargo "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" cargo-generate --features vendored-openssl\ncargo "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" cargo-run-script\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("h3",{attrs:{id:"setup-osmosis-testnet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup-osmosis-testnet"}},[t._v("#")]),t._v(" Setup Osmosis Testnet")]),t._v(" "),e("p",[t._v("You can easily set up an Osmosis Testnet environment using the "),e("a",{attrs:{href:"https://github.com/osmosis-labs/osmosis-installer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Osmosis Installer"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Run the following and choose option #2 (Client Node) and #2 (Testnet) in order.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sL https://get.osmosis.zone/install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" i.py "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" python3 i.py\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("Now you have successfully completed setting up an Osmosis client node in Testnet. In order to use "),e("code",[t._v("osmosisd")]),t._v(" from the cli, either reload your terminal or refresh your profile with : "),e("code",[t._v("‘source ~/.profile’")])]),t._v(" "),e("h3",{attrs:{id:"setup-the-client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup-the-client"}},[t._v("#")]),t._v(" Setup the Client")]),t._v(" "),e("p",[t._v("First, create a wallet with the command following:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# add wallets for testing")]),t._v("\nosmosisd keys "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" wallet\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("When you run the commands above, "),e("code",[t._v("osmosisd")]),t._v(" will prompt you all the information related to that wallet in YAML (.yml) format.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("- name: wallet\n  type: "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("\n  address: osmo1v9yrqx8aaddlna29zxngr4ye3jnxtpprrej532\n  pubkey: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"AmKFqbczx7j/sYlqO2irXUSsQMdEN9Ugg1W2AOm7knh3"}\'')]),t._v("\n  mnemonic: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n**Important** "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" this mnemonic phrase "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" a safe place.\nIt is the only way to recover your account "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" you ever forget your password.\n\ndivert cliff issue spirit penalty chief improve neck enjoy pipe sing loop inherit behind space next tourist acid axis easy never ball enemy moment\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("p",[t._v("You need some tokens named "),e("code",[t._v("OSMO")]),t._v("("),e("code",[t._v("uosmo")]),t._v(") in your address to interact with the network.")]),t._v(" "),e("h3",{attrs:{id:"faucet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#faucet"}},[t._v("#")]),t._v(" faucet")]),t._v(" "),e("h4",{attrs:{id:"official-faucet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#official-faucet"}},[t._v("#")]),t._v(" Official Faucet")]),t._v(" "),e("p",[t._v("You can request tokens from the official faucet at "),e("a",{attrs:{href:"https://faucet.osmosis.zone",target:"_blank",rel:"noopener noreferrer"}},[t._v("faucet.osmosis.zone"),e("OutboundLink")],1)]),t._v(" "),e("h4",{attrs:{id:"discord-faucet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#discord-faucet"}},[t._v("#")]),t._v(" Discord Faucet")]),t._v(" "),e("p",[t._v("Youcan also participate in the "),e("a",{attrs:{href:"https://discord.com/invite/osmosis",target:"_blank",rel:"noopener noreferrer"}},[t._v("Osmosis discord"),e("OutboundLink")],1),t._v(" to request a faucet of the Osmosis Testnet. After gaining access to the testnet channel on the "),e("code",[t._v("#roles")]),t._v(" channel of the discord, you can request a testnet token by sending the following message on the "),e("code",[t._v("#faucet")]),t._v(" channel:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172293039-b832fd96-d62d-44de-9889-ee400a9ec815.png",alt:""}}),t._v(" "),e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172293080-aee186ad-ef51-43bb-ac6e-1a8b65c9ce04.png",alt:""}})]),t._v(" "),e("p",[t._v("Then, you can check that your faucet request has been successful by checking the balance of your wallet bank account by trying the command:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("osmosisd query bank balances "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("osmosisd keys show -a wallet"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd query bank balances [address]")]),t._v(" commands query the total balance of an account.")]),t._v(" "),e("li",[e("code",[t._v("osmosisd keys show -a wallet")]),t._v(" commands returns the address of the wallet that you created.")])]),t._v(" "),e("h2",{attrs:{id:"deploy-a-smart-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-a-smart-contract"}},[t._v("#")]),t._v(" Deploy a Smart Contract")]),t._v(" "),e("h3",{attrs:{id:"clone-cw-template"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clone-cw-template"}},[t._v("#")]),t._v(" Clone cw-template")]),t._v(" "),e("p",[t._v("For this example, we will use the "),e("a",{attrs:{href:"https://github.com/osmosis-labs/cw-tpl-osmosis",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[t._v("cw-template")]),e("OutboundLink")],1),t._v(" repo with counter example.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("cargo generate --git https://github.com/osmosis-labs/cw-tpl-osmosis.git --name my-first-contract\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" my-first-contract\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h3",{attrs:{id:"compile-the-wasm-contract-with-stable-toolchain"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compile-the-wasm-contract-with-stable-toolchain"}},[t._v("#")]),t._v(" Compile the wasm contract with stable toolchain")]),t._v(" "),e("p",[t._v("To deploy smart contracts, you must compile the code and make it an executable wasm binary file. We will compile the wasm contract with stable toolchain.")]),t._v(" "),e("p",[t._v("Compile using the command below:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Set 'stable' as the default release channel:")]),t._v("\nrustup default stable\ncargo wasm\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("ul",[e("li",[e("p",[e("code",[t._v("toolchain")]),t._v(" means the compiler of  Rust, and rust has three release channels: "),e("code",[t._v("stable")]),t._v(", "),e("code",[t._v("beta")]),t._v(", and "),e("code",[t._v("nightly")]),t._v(", of which the "),e("code",[t._v("stable")]),t._v(" channel is the most recently released version. "),e("code",[t._v("rustup")]),t._v(" helps you manage these different versions easily.")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("cargo")]),t._v(" is the "),e("em",[t._v("Rust package manager")]),t._v(". In the "),e("a",{attrs:{href:"https://github.com/InterWasm/cw-template/blob/main/.cargo/config",target:"_blank",rel:"noopener noreferrer"}},[t._v(".cargo/config"),e("OutboundLink")],1),t._v(", you can view the wasm compilation options as follows:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("wasm "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build --release --target wasm32-unknown-unknown"')]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("So when we run the "),e("code",[t._v("cargo wasm")]),t._v(" command, the "),e("code",[t._v("cargo build --release —-target wasm32-unknown-unknown")]),t._v(" command is executed according to the option in the config file above.")])])]),t._v(" "),e("p",[t._v("After this compiles, it should produce a file in "),e("code",[t._v("target/wasm32-unknown-unknown/release/my_first_contract.wasm")]),t._v(".  If you check the size of the file by using the "),e("code",[t._v("ls -lh")]),t._v(" command, it shows around "),e("code",[t._v("1.8M")]),t._v(". This is a release build, but not stripped of all unneeded code. To produce a much smaller version, you can run this which tells the compiler to strip all unused code out:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RUSTFLAGS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-C link-arg=-s'")]),t._v(" cargo wasm\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("This produces a file about "),e("code",[t._v("155K")]),t._v(". To reduce gas costs, the binary size should be as small as possible. This will result in a less costly deployment, and lower fees on every interaction.")]),t._v(" "),e("p",[t._v("Also, if you don’t use compilation optimization, CosmWasm smart contract will not be deployed well due to "),e("code",[t._v("exceeds limit")]),t._v(" error.")]),t._v(" "),e("h3",{attrs:{id:"optimized-compilation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#optimized-compilation"}},[t._v("#")]),t._v(" Optimized Compilation")]),t._v(" "),e("p",[t._v("You can do further optimization using "),e("a",{attrs:{href:"https://github.com/CosmWasm/rust-optimizer",target:"_blank",rel:"noopener noreferrer"}},[t._v("rust-optimizer"),e("OutboundLink")],1),t._v(". "),e("strong",[t._v("rust-optimizer")]),t._v(" produces reproducible builds of CosmWasm smart contracts and does heavy optimization on the build size, using binary stripping and "),e("code",[t._v("wasm-opt")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" docker run --rm -v "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('"')]),t._v(":/code "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --mount "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("volume,source"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$(basename "'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v('_cache",target'),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/code/target "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --mount "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("volume,source"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("registry_cache,target"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/cargo/registry "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    cosmwasm/rust-optimizer:0.12.6\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("Binary file will be at "),e("code",[t._v("artifacts/my_first_contract.wasm")]),t._v(" folder and its size will be about "),e("code",[t._v("130K")]),t._v(", which is more smaller than when only RUTFLAGS was used.")]),t._v(" "),e("h3",{attrs:{id:"store-to-osmosis-testnet-chain"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#store-to-osmosis-testnet-chain"}},[t._v("#")]),t._v(" Store to Osmosis Testnet chain")]),t._v(" "),e("p",[t._v("We have the wasm binary executable ready. Now it is time to store the code to the Osmosis Testnet blockchain.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# store the code on chain")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RES")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("osmosisd tx wasm store artifacts/my_first_contract.wasm --from wallet --gas-prices "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".1uosmo --gas auto --gas-adjustment "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.3")]),t._v(" -y --output json -b block"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd tx wasm store")]),t._v(" : upload a wasm binary")]),t._v(" "),e("li",[e("code",[t._v("--from")]),t._v(" : name or address of private key with which to sign.")]),t._v(" "),e("li",[e("code",[t._v("--gas-prices")]),t._v(" : gas prices in decimal format to determine the transaction fee.")]),t._v(" "),e("li",[e("code",[t._v("--gas")]),t._v(' : gas limit to set per-transaction. set to "'),e("code",[t._v("auto")]),t._v('" to calculate sufficient gas automatically')]),t._v(" "),e("li",[e("code",[t._v("--gas-adjustment")]),t._v(" : adjustment factor to be multiplied against the estimate returned by the tx simulation.")]),t._v(" "),e("li",[e("code",[t._v("-y")]),t._v(" : to skip tx broadcasting prompt confirmation.")]),t._v(" "),e("li",[e("code",[t._v("--output")]),t._v(" : output format.")]),t._v(" "),e("li",[e("code",[t._v("-b")]),t._v(" : transaction broadcasting mode")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172293654-7beba11b-ce5f-4979-94e2-19156c6e5b27.png",alt:""}})]),t._v(" "),e("p",[t._v("Once that is complete, you can get the "),e("code",[t._v("CODE_ID")]),t._v(" easily using "),e("code",[t._v("jq")]),t._v(".")]),t._v(" "),e("p",[e("code",[t._v("jq")]),t._v(" is an open source that helps extract data from JSON. Install it according to your OS using the following command:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Linux")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jq\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Mac")]),t._v("\nbrew "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jq\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("p",[t._v("If you are using an operating system other than the one listed above, please refer to the "),e("a",{attrs:{href:"https://stedolan.github.io/jq/download/",target:"_blank",rel:"noopener noreferrer"}},[t._v("official document"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Run the following command to set the "),e("code",[t._v("CODE_ID")]),t._v(" as a variable:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# get CODE_ID")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CODE_ID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" $RES "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" jq -r "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.logs[0].events[-1].attributes[0].value'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CODE_ID")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172293774-e60b8d0b-a5c3-48db-9c79-4f4f427eb59b.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"instantiate-the-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#instantiate-the-contract"}},[t._v("#")]),t._v(" Instantiate the contract")]),t._v(" "),e("p",[t._v("We can now create an instance of this wasm contract. First, set the initial state of the instance in the "),e("code",[t._v("INIT")]),t._v(" variable and run the "),e("code",[t._v("instantiate")]),t._v(" command.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set the initial state of the instance")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("INIT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{\"count\":100}'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# instantiate the contract")]),t._v("\nosmosisd tx wasm instantiate "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CODE_ID")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$INIT")]),t._v('"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from wallet --label "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my first contract"')]),t._v(" --gas-prices "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".025uosmo --gas auto --gas-adjustment "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.3")]),t._v(" -b block -y --no-admin\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd tx wasm instantiate")]),t._v(" : instantiate a wasm contract using CODE_ID of the uploaded binary.")]),t._v(" "),e("li",[e("code",[t._v("--label")]),t._v(" : human-readable name for this contract in lists.")]),t._v(" "),e("li",[e("code",[t._v("--no-admin")]),t._v(" : you must set this explicitly if you don’t want an admin.")])]),t._v(" "),e("p",[t._v("If you have succeeded in instantiating the contract, you can search for output "),e("code",[t._v("txhash")]),t._v(" in "),e("a",{attrs:{href:"https://testnet.ping.pub/osmosis",target:"_blank",rel:"noopener noreferrer"}},[t._v("Osmosis Explorer"),e("OutboundLink")],1),t._v(" to verify your deployment.")]),t._v(" "),e("p",[t._v("Get the contract address using the command following:")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CONTRACT_ADDR")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("osmosisd query wasm list-contract-by-code $CODE_ID --output json "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" jq -r "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.contracts[0]'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd query wasm list-contract-by-code")]),t._v(" : list wasm all bytecode on the chain for given code id")])]),t._v(" "),e("h2",{attrs:{id:"execute-the-contract"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#execute-the-contract"}},[t._v("#")]),t._v(" Execute the Contract")]),t._v(" "),e("p",[t._v("Now, let's see if the contract we deployed works well.")]),t._v(" "),e("h3",{attrs:{id:"get-contract-s-count"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#get-contract-s-count"}},[t._v("#")]),t._v(" Get contract’s count")]),t._v(" "),e("p",[t._v("Send a "),e("code",[t._v("get_count")]),t._v(" query to check the count value. The previously set "),e("code",[t._v("INIT")]),t._v(" state is output as it is.: "),e("code",[t._v('{"data":{"count":100}}')])]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("QUERY")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{\"get_count\":{}}'")]),t._v("\nosmosisd query wasm contract-state smart "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CONTRACT_ADDR")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$QUERY")]),t._v('"')]),t._v(" --output json\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd query wasm contract-state smart")]),t._v(" : calls contract with given address with query data and prints the returned result")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172295110-e3ae455c-9681-41a4-abf2-ac33288bb13c.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"increment-contract-s-count"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#increment-contract-s-count"}},[t._v("#")]),t._v(" Increment contract’s count")]),t._v(" "),e("p",[t._v("This time, let's send an "),e("code",[t._v("increment")]),t._v(" transaction that increases the count value by +1. Because the transaction changes the internal state of the contract, you must pay gas fees.")]),t._v(" "),e("p",[t._v("If you run the "),e("code",[t._v("get_count")]),t._v(" query again after sending the "),e("code",[t._v("increment")]),t._v(" transaction, you can see that +1 has increased from the previous count value.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TRY_INCREMENT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{\"increment\": {}}'")]),t._v("\nosmosisd tx wasm execute "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CONTRACT_ADDR")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$TRY_INCREMENT")]),t._v('"')]),t._v(" --from wallet --gas-prices "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".025uosmo --gas auto --gas-adjustment "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.3")]),t._v(" -y\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("ul",[e("li",[e("code",[t._v("osmosisd tx wasm execute")]),t._v(" : execute a command on a wasm contract")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172295183-89016c41-7832-41c4-b4c7-a2cf9d441256.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"reset-contract-s-count"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#reset-contract-s-count"}},[t._v("#")]),t._v(" Reset contract’s count")]),t._v(" "),e("p",[t._v("Lastly, let’s send a "),e("code",[t._v("reset")]),t._v(" transaction. Like increment, reset transaction also changes the internal state of contract, so you must pay gas fees.")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RESET")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"reset": {"count": 0}}\'')]),t._v("\nosmosisd tx wasm execute "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CONTRACT_ADDR")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RESET")]),t._v('"')]),t._v(" --from wallet --gas-prices "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".025uosmo --gas auto --gas-adjustment "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.3")]),t._v(" -y\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172295239-ddf95369-5b9a-4096-a84d-aecc1ef30484.png",alt:""}})]),t._v(" "),e("h2",{attrs:{id:"osmo-contract-explorer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#osmo-contract-explorer"}},[t._v("#")]),t._v(" Osmo Contract Explorer")]),t._v(" "),e("p",[t._v("You can also instantiate the contract using intuitive GUI in "),e("a",{attrs:{href:"https://osmosis-contracts.web.app/#/codes",target:"_blank",rel:"noopener noreferrer"}},[t._v("Osmo Contract Explorer"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Let’s do it together")]),t._v(" "),e("h3",{attrs:{id:"upload-the-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#upload-the-code"}},[t._v("#")]),t._v(" Upload the code")]),t._v(" "),e("p",[t._v("When you access the site, you will see a list of the code we uploaded to the chain and the contract instances created using the corresponding CODE_ID.")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172296987-b8df32a4-f50e-4546-8773-a257a21fb92d.png",alt:""}})]),t._v(" "),e("p",[t._v("First, Login by connecting your wallet. Then click the "),e("code",[t._v("Create a Contract")]),t._v(" button and enter the initial state of the instance in "),e("code",[t._v("Instantiate Message")]),t._v(". After also entering label and admin, you can easily create a contract instance by clicking the "),e("code",[t._v("Instantiate Contract")]),t._v(" button.")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172297151-64146bba-d7d4-444f-9a57-06dd55f62db8.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"execute-the-contract-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#execute-the-contract-2"}},[t._v("#")]),t._v(" Execute the contract")]),t._v(" "),e("p",[t._v("Now, let's send a transaction to the contract to see if the contract works well.")]),t._v(" "),e("p",[t._v("You can send a query in the "),e("code",[t._v("Read Contract")]),t._v(" section and you can send transactions that change the internal state of the contract in the "),e("code",[t._v("Write Contract")]),t._v(" section.")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172298609-95a0269d-ae58-472b-b02e-c2b1b5f3c4e6.png",alt:""}})]),t._v(" "),e("h4",{attrs:{id:"get-count"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#get-count"}},[t._v("#")]),t._v(" get_count")]),t._v(" "),e("p",[t._v("In the Read Contract section, type "),e("code",[t._v("get_count")]),t._v(" messages and press the "),e("code",[t._v("Run query")]),t._v(" button to get the count value.")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172300337-eda6f76a-ad31-45d3-a5a1-8d324c2bc966.png",alt:""}})]),t._v(" "),e("h4",{attrs:{id:"increment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#increment"}},[t._v("#")]),t._v(" increment")]),t._v(" "),e("p",[t._v("In the Write Contract section, type "),e("code",[t._v("increment")]),t._v(" messages and the OSMO to pay and click the "),e("code",[t._v("Execute Contract")]),t._v(" button to execute the transaction.")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172300637-bb29452d-1d23-4c30-8cbb-d72f358b490e.png",alt:""}})]),t._v(" "),e("h4",{attrs:{id:"reset"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#reset"}},[t._v("#")]),t._v(" reset")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/70956926/172300485-4d66b5a9-1082-48da-ba1c-b979206f277e.png",alt:""}})]),t._v(" "),e("p",[t._v("Congratulations! Now you deployed your wasm smart contract on Osmosis Testnet successfully.")])])}),[],!1,null,null,null);s.default=n.exports}}]);