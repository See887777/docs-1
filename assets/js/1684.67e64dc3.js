"use strict";(self.webpackChunkosmosis_docs=self.webpackChunkosmosis_docs||[]).push([[1684],{43367:(t,e,i)=>{var n;i.d(e,{R:()=>n}),function(t){t.REQUEST_RECEIVED="REQUEST_RECEIVED",t.REQUEST_SENT="REQUEST_SENT",t.INCOMING_REQUEST_ACCEPTED="INCOMING_REQUEST_ACCEPTED",t.OUTGOING_REQUEST_ACCEPTED="OUTGOING_REQUEST_ACCEPTED",t.INCOMING_REQUEST_ENDED="INCOMING_REQUEST_ENDED",t.OUTGOING_REQUEST_ENDED="OUTGOING_REQUEST_ENDED"}(n||(n={}))},41684:(t,e,i)=>{i.r(e),i.d(e,{dyte_notifications:()=>f});var n=i(94196),s=i(43367),o=i(29799),a=i(67553),r=i(7147),d=i(61070),c=i(47502),p=(i(72559),i(79781));i(41969),i(55752);const l={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",left:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"};class h{constructor(){this.audio=document.createElement("audio"),this.audio.volume=.3}play(t,e=3e3){var i;this.playing||(this.playing=!0,this.audio.src=l[t],this.audio.volume=.3,null===(i=this.audio.play())||void 0===i||i.catch((i=>{o.l.error("[dyte-notifications] play() failed\n",{sound:t,duration:e},i)})),setTimeout((()=>{this.playing=!1}),e))}async setDevice(t){var e,i,n;await(null===(n=null===(i=null===(e=this.audio)||void 0===e?void 0:e.setSinkId)||void 0===i?void 0:i.call(e,t))||void 0===n?void 0:n.catch((t=>{o.l.error("[dyte-notifications] setSinkId() error\n",t)})))}}const u=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10}),m=2e3;function g(t){return Object.keys(t).filter((e=>t[e]))}const f=class{constructor(t){(0,n.r)(this,t),this.permissions=u,this.enabledSounds=g(u.notification_sounds),this.config=c.d,this.t=(0,d.u)(),this.iconPack=r.d,this.notifications=[],this.onRemoteUpdate=({payload:t,type:e})=>{if(e===s.R.INCOMING_REQUEST_ACCEPTED){let e=this.meeting.participants.joined.get(t.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Granted remote control to ${e.name}`,duration:m})}if(e===s.R.OUTGOING_REQUEST_ACCEPTED){let e=this.meeting.participants.joined.get(t.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${e.name} has granted remote control.`,duration:m})}if(e===s.R.REQUEST_RECEIVED){let e=this.meeting.participants.joined.get(t.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${e.name} has requested for remote control.`,duration:m})}if(e!==s.R.INCOMING_REQUEST_ENDED&&e!==s.R.OUTGOING_REQUEST_ENDED||this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:"Existing remote control has been terminated.",duration:m}),e===s.R.REQUEST_SENT){let e=this.meeting.participants.joined.get(t.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Sent remote control request to ${e.name}`,duration:m})}},this.onDyteNotification=t=>{this.add(t.detail);const e=t.detail.playSound;null!=e&&this.audio.play(e)}}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(t){this.participantJoinedListener&&t.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&t.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.chatUpdateListener&&t.chat.removeListener("chatUpdate",this.chatUpdateListener),this.pollUpdateListener&&t.polls.removeListener("pollsUpdate",this.pollUpdateListener),this.networkUpdateListener&&t.meta.removeListener("disconnected",this.networkUpdateListener),this.networkUpdateListener&&t.meta.removeListener("connected",this.networkUpdateListener),t.remote.removeListener("remoteUpdate",this.onRemoteUpdate),clearTimeout(this.disconnectTimeout)}disconnectedCallback(){var t;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.participantJoinedListener&&this.meeting.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.chatUpdateListener&&this.meeting.chat.removeListener("chatUpdate",this.chatUpdateListener),this.pollUpdateListener&&this.meeting.polls.removeListener("pollsUpdate",this.pollUpdateListener),this.networkUpdateListener&&this.meeting.meta.removeListener("disconnected",this.networkUpdateListener),this.networkUpdateListener&&this.meeting.meta.removeListener("connected",this.networkUpdateListener),this.meeting.remote.removeListener("remoteUpdate",this.onRemoteUpdate),this.spotlightTabUpdateListener&&(null===(t=this.meeting.spotlight)||void 0===t||t.removeListener("activeTabUpdate",this.spotlightTabUpdateListener)),this.peerRequestToJoinStateListener&&this.meeting.participants.joined.removeListener("peerRequestToJoinStage",this.peerRequestToJoinStateListener),this.peerAcceptedToJoinStageListener&&this.meeting.participants.joined.removeListener("peerAcceptedToJoinStage",this.peerAcceptedToJoinStageListener),this.peerRejectedToJoinStageListener&&this.meeting.participants.joined.removeListener("peerRejectedToJoinStage",this.peerRejectedToJoinStageListener))}meetingChanged(t,e){var i;if(clearTimeout(this.disconnectTimeout),void 0!==e&&this.clearListeners(e),null!=t){this.audio=new h,this.participantJoinedListener=t=>{this.permissions.notifications.participant_joined&&this.add({id:`${t.id}-joined`,message:`${(0,a.f)(t.name)} just joined`,image:t.picture,duration:2100}),this.permissions.notification_sounds.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=t=>{this.permissions.notifications.participant_left&&this.add({id:`${t.id}-left`,message:`${(0,a.f)(t.name)} left`,image:t.picture,duration:2100}),this.permissions.notification_sounds.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=t=>{const e=`${t.id}-joined-waitlist`;this.add({id:e,message:`${(0,a.f)(t.name)} is requesting to join the meeting`,image:t.picture,duration:4e3,button:{text:"Accept",variant:"secondary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(t.id),this.remove(e)}}})},this.chatUpdateListener=({message:e})=>{if(null!=e){if(e.userId===t.self.userId)return;"text"===e.type&&(this.permissions.notifications.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${e.displayName}: ${(0,a.s)(e.message,20)}`,duration:m}),this.permissions.notification_sounds.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:t})=>{this.permissions.notifications.polls&&this.meeting.self.userId!==t[t.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`New poll created by ${t[t.length-1].createdBy}`,duration:m}),this.permissions.notification_sounds.polls&&this.meeting.self.userId!==t[t.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message")},this.deviceUpdateListener=({device:t,preview:e})=>{e||"audiooutput"===t.kind&&this.audio.setDevice(t.deviceId)},this.networkUpdateListener=({event:t})=>{let e;this.remove("network"),"disconnected"===t?(e=2e4,this.add({id:"network",icon:this.iconPack.disconnected,message:this.t("Connection lost. Trying to reconnect..."),duration:e}),this.disconnectTimeout=setTimeout((()=>{null!=this.states&&(this.states.roomLeftState="disconnected",p.s.roomLeftState="disconnected"),this.add({id:"network-lost",icon:this.iconPack.disconnected,message:this.t("Taking too long to reconnect..."),button:{text:this.t("End Meeting"),variant:"danger",onClick:()=>{var t;return null===(t=this.meeting)||void 0===t?void 0:t.leaveRoom()}}})}),e)):"connected"===t&&(this.remove("network-lost"),e=3e3,this.add({id:"network",icon:this.iconPack.wifi,message:this.t("Connection restored"),duration:e}),clearTimeout(this.disconnectTimeout))},this.spotlightTabUpdateListener=e=>{switch(e.type){case"plugin":const i=t.plugins.active.toArray().find((t=>t.id==e.id));null!=i&&this.add({id:"spotlight",message:`Plugin switched to ${i.name}`,duration:m});break;case"screenshare":const n=t.participants.joined.toArray().filter((t=>t.screenShareEnabled)).find((t=>t.id==e.id));null!=n&&this.add({id:"spotlight",message:`Now watching ${n.name}'s screen`,duration:m})}},this.peerRequestToJoinStateListener=({id:t})=>{const e=this.meeting.participants.joined.get(t);void 0!==e&&(this.add({id:`webinar-request-${t}`,message:`${e.name} is requesting to be on stage`,duration:m,button:{text:"Accept",variant:"primary",onClick:async()=>{await this.meeting.participants.acceptAllRequestToJoinStageRequests([{id:t,requestToJoinType:"REQUEST_TO_PRESENT"}]),this.remove(`webinar-request-${t}`)}}}),this.permissions.notifications.webinar&&this.audio.play("joined"))},this.peerAcceptedToJoinStageListener=t=>{const e=this.meeting.participants.joined.get(t.id);void 0!==e&&(this.add({id:`webinar-accepted-${t.id}`,message:`Approved ${e.name}'s request to join stage.`,duration:m}),this.permissions.notifications.webinar&&this.audio.play("joined"))},this.peerRejectedToJoinStageListener=t=>{const e=this.meeting.participants.joined.get(t.id);void 0!==e&&this.add({id:`webinar-rejected-${t.id}`,message:`Rejected ${e.name}'s request to join stage.`,duration:m})};const e=t.self.getCurrentDevices();null!=e.speaker&&this.audio.setDevice(e.speaker.deviceId),t.participants.joined.addListener("participantJoined",this.participantJoinedListener),t.participants.joined.addListener("participantLeft",this.participantLeftListener),t.participants.joined.addListener("peerRequestToJoinStage",this.peerRequestToJoinStateListener),t.participants.joined.addListener("peerAcceptedToJoinStage",this.peerAcceptedToJoinStageListener),t.participants.joined.addListener("peerRejectedToJoinStage",this.peerRejectedToJoinStageListener),this.canAcceptWaitingRequests()&&t.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),t.chat.addListener("chatUpdate",this.chatUpdateListener),t.polls.addListener("pollsUpdate",this.pollUpdateListener),t.self.addListener("deviceUpdate",this.deviceUpdateListener),t.meta.addListener("disconnected",(()=>this.networkUpdateListener({event:"disconnected"}))),t.meta.addListener("connected",(()=>this.networkUpdateListener({event:"connected"}))),t.remote.addListener("remoteUpdate",this.onRemoteUpdate),null===(i=t.spotlight)||void 0===i||i.addListener("activeTabUpdate",this.spotlightTabUpdateListener)}}configChanged(t){null!=t&&null!=(null==t?void 0:t.config)&&(this.permissions=function(t){const e=Object.assign({},u);return null==t||(Object.assign(e.notification_sounds,t.notification_sounds),Object.assign(e.notifications,t.notifications),e.participant_chat_message_sound_notification_limit=t.participant_chat_message_sound_notification_limit,e.participant_joined_sound_notification_limit=t.participant_joined_sound_notification_limit),e}(t.config),this.enabledSounds=g(this.permissions.notification_sounds))}statesChanged(t){var e;if(null!=t){const i=!(null===(e=null==t?void 0:t.prefs)||void 0===e?void 0:e.muteNotificationSounds);for(const t of this.enabledSounds)t in this.permissions.notification_sounds&&(this.permissions.notification_sounds[t]=i)}}add(t){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,t])}remove(t){this.notifications=this.notifications.filter((e=>e.id!==t))}handleDismiss(t){t.stopPropagation();const e=t.detail,i=this.host.shadowRoot.querySelector(`[data-id="${e}"]`);null==i||i.classList.add("exit"),setTimeout((()=>{(0,n.w)((()=>{this.remove(e)}))}),400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return(0,n.h)(n.H,null,this.notifications.map((t=>(0,n.h)("dyte-notification",{size:this.size,key:t.id,"data-id":t.id,notification:t,onDyteNotificationDismiss:t=>this.handleDismiss(t)}))))}get host(){return(0,n.g)(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};f.style=":host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;z-index:10;display:flex;flex-direction:column;font-family:var(--dyte-font-family, sans-serif);pointer-events:none}dyte-notification{margin-top:var(--dyte-space-2, 8px)}"},61070:(t,e,i)=>{i.d(e,{g:()=>s,u:()=>o});var n=i(55752);const s=async t=>{if(null==t||"en"===t||""===t.trim())return n.d;try{const e=await fetch(`http://localhost:5000/${t}.json`);return e.ok?Object.assign({},n.d,await e.json()):n.d}catch(e){return n.d}},o=(t=n.d)=>e=>{var i;return null!==(i=t[e])&&void 0!==i?i:e}},29799:(t,e,i)=>{i.d(e,{l:()=>s});var n=i(41969),s=(0,n.c)((function(t){var e,i;e=n.a,i=function(){var t=function(){},e="undefined",i=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function s(t,e){var i=t[e];if("function"==typeof i.bind)return i.bind(t);try{return Function.prototype.bind.call(i,t)}catch(n){return function(){return Function.prototype.apply.apply(i,[t,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(n){return"debug"===n&&(n="log"),typeof console!==e&&("trace"===n&&i?o:void 0!==console[n]?s(console,n):void 0!==console.log?s(console,"log"):t)}function r(e,i){for(var s=0;s<n.length;s++){var o=n[s];this[o]=s<e?t:this.methodFactory(o,e,i)}this.log=this.debug}function d(t,i,n){return function(){typeof console!==e&&(r.call(this,i,n),this[t].apply(this,arguments))}}function c(t,e,i){return a(t)||d.apply(this,arguments)}function p(t,i,s){var o,a=this;i=null==i?"WARN":i;var d="loglevel";function p(){var t;if(typeof window!==e&&d){try{t=window.localStorage[d]}catch(s){}if(typeof t===e)try{var i=window.document.cookie,n=i.indexOf(encodeURIComponent(d)+"=");-1!==n&&(t=/^([^;]+)/.exec(i.slice(n))[1])}catch(s){}return void 0===a.levels[t]&&(t=void 0),t}}"string"==typeof t?d+=":"+t:"symbol"==typeof t&&(d=void 0),a.name=t,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=s||c,a.getLevel=function(){return o},a.setLevel=function(i,s){if("string"==typeof i&&void 0!==a.levels[i.toUpperCase()]&&(i=a.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(o=i,!1!==s&&function(t){var i=(n[t]||"silent").toUpperCase();if(typeof window!==e&&d){try{return void(window.localStorage[d]=i)}catch(s){}try{window.document.cookie=encodeURIComponent(d)+"="+i+";"}catch(s){}}}(i),r.call(a,i,t),typeof console===e&&i<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(t){i=t,p()||a.setLevel(t,!1)},a.resetLevel=function(){a.setLevel(i,!1),function(){if(typeof window!==e&&d){try{return void window.localStorage.removeItem(d)}catch(t){}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(t){}}}()},a.enableAll=function(t){a.setLevel(a.levels.TRACE,t)},a.disableAll=function(t){a.setLevel(a.levels.SILENT,t)};var l=p();null==l&&(l=i),a.setLevel(l,!1)}var l=new p,h={};l.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=h[t];return e||(e=h[t]=new p(t,l.getLevel(),l.methodFactory)),e};var u=typeof window!==e?window.log:void 0;return l.noConflict=function(){return typeof window!==e&&window.log===l&&(window.log=u),l},l.getLoggers=function(){return h},l.default=l,l},t.exports?t.exports=i():e.log=i()}));s.enableAll()},79781:(t,e,i)=>{i.d(e,{o:()=>d,s:()=>r});var n=i(94196);const s=t=>!("isConnected"in t)||t.isConnected,o=((t,e)=>{let i;return(...n)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,t(...n)}),e)}})((t=>{for(let e of t.keys())t.set(e,t.get(e).filter(s))}),2e3),a=(t,e)=>{const i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],t.length--)},{state:r,onChange:d}=((t,e)=>{const i=((t,e=((t,e)=>t!==e))=>{let i=new Map(Object.entries(null!=t?t:{}));const n={dispose:[],get:[],set:[],reset:[]},s=()=>{i=new Map(Object.entries(null!=t?t:{})),n.reset.forEach((t=>t()))},o=t=>(n.get.forEach((e=>e(t))),i.get(t)),r=(t,s)=>{const o=i.get(t);e(s,o,t)&&(i.set(t,s),n.set.forEach((e=>e(t,s,o))))},d="undefined"==typeof Proxy?{}:new Proxy(t,{get:(t,e)=>o(e),ownKeys:t=>Array.from(i.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(t,e)=>i.has(e),set:(t,e,i)=>(r(e,i),!0)}),c=(t,e)=>(n[t].push(e),()=>{a(n[t],e)});return{state:d,get:o,set:r,on:c,onChange:(e,i)=>{const n=c("set",((t,n)=>{t===e&&i(n)})),s=c("reset",(()=>i(t[e])));return()=>{n(),s()}},use:(...t)=>{const e=t.reduce(((t,e)=>(e.set&&t.push(c("set",e.set)),e.get&&t.push(c("get",e.get)),e.reset&&t.push(c("reset",e.reset)),e.dispose&&t.push(c("dispose",e.dispose)),t)),[]);return()=>e.forEach((t=>t()))},dispose:()=>{n.dispose.forEach((t=>t())),s()},reset:s,forceUpdate:t=>{const e=i.get(t);n.set.forEach((i=>i(t,e,e)))}}})(t,e);return i.use((()=>{if("function"!=typeof n.a)return{};const t=new Map;return{dispose:()=>t.clear(),get:e=>{const i=(0,n.a)();i&&((t,e,i)=>{const n=t.get(e);n?n.includes(i)||n.push(i):t.set(e,[i])})(t,e,i)},set:e=>{const i=t.get(e);i&&t.set(e,i.filter(n.f)),o(t)},reset:()=>{t.forEach((t=>t.forEach(n.f))),o(t)}}})()),i})({})},67553:(t,e,i)=>{i.d(e,{a:()=>o,f:()=>a,h:()=>s,s:()=>n});const n=(t,e=20)=>null==t?"":t.length>e?`${t.substring(0,e)}...`:t,s=t=>/^\p{Emoji}+$/u.test(t)&&!/^\d+$/.test(t),o=t=>(null==t?void 0:t.trim().toLowerCase().startsWith("javascript:"))?"https://dyte.io":t,a=t=>""===(t=null==t?void 0:t.trim())?"Participant":t}}]);